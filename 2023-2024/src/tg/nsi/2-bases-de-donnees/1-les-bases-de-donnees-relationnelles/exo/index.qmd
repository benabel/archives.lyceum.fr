---
title: Exercices
subtitle: "Chapitre 1: Les bases de données relationnelles"
exo: true
type: exo
tabnav: true
---
## Édition de données `csv`

En utilisant les données des oscars issues de wikidata, nous allons montrer les limites de l'utilisation de fichiers de tableaux type `csv` vus en [première].

Pour cela vous travaillerez sur le fichier framacalc disponible en ligne à l'adresse suivante: https://lite.framacalc.org/oscars-9rvu

Qui contient les [données] sur les Oscars _seulement jusqu'en 2020_.

Votre mission si vous l'acceptez est de rajouter les données manquantes disponibles dans l'`<iframe>`ci-dessous.

**Après avoir _(tenté)_ de mettre à jour ces données, expliquez quelles sont les limites de
l'utilisation de fichiers de tables(`csv`, `ods`, `xlsx`), et quel est l'intérêt d'utiliser un SGBD(Système de gestion de bases de données).**

<iframe style="width: 100%; height: 50vh; border: none;" src="https://query.wikidata.org/embed.html#%23Donn%C3%A9es%20sur%20les%20Oscars%0ASELECT%20%3Fhuman%20%3FhumanLabel%20%3FawardEditionLabel%20%3FawardLabel%20%3FawardWork%20%3FawardWorkLabel%20%3Fdirector%20%3FdirectorLabel%20%3Ftime%0AWHERE%0A%7B%0A%20%20%7B%0A%20%20%20%20SELECT%20(SAMPLE(%3Fhuman)%20AS%20%3Fhuman)%20%3Faward%20%3FawardWork%20(SAMPLE(%3Fdirector)%20AS%20%3Fdirector)%20(SAMPLE(%3FawardEdition)%20AS%20%3FawardEdition)%20(SAMPLE(%3Ftime)%20AS%20%3Ftime)%20WHERE%20%7B%0A%20%20%20%20%20%20%3Faward%20wdt%3AP31%20wd%3AQ19020%20.%20%20%20%20%20%20%23%20All%20items%20that%20are%20instance%20of(P31)%20of%20Academy%20awards%20(Q19020)%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%3Fhuman%20p%3AP166%20%3FawardStat%20.%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Humans%20with%20an%20awarded(P166)%20statement%0A%20%20%20%20%20%20%20%20%3FawardStat%20ps%3AP166%20%3Faward%20.%20%20%20%20%20%20%20%20%23%20...%20that%20has%20any%20of%20the%20values%20of%20%3Faward%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP805%20%3FawardEdition%20.%20%23%20Get%20the%20award%20edition%20(which%20is%20%22subject%20of%22%20XXth%20Academy%20Awards)%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP1686%20%3FawardWork%20.%20%23%20The%20work%20they%20have%20been%20awarded%20for%0A%20%20%20%20%20%20%20%20%3Fhuman%20wdt%3AP31%20wd%3AQ5%20.%20%20%20%20%20%20%20%20%23%20Humans%0A%20%20%20%20%20%20%7D%20UNION%20%7B%0A%20%20%20%20%20%20%20%20%3FawardWork%20wdt%3AP31%20wd%3AQ11424%20.%20%23%20Films%0A%20%20%20%20%20%20%20%20%3FawardWork%20p%3AP166%20%3FawardStat%20.%20%23%20...%20with%20an%20awarded(P166)%20statement%0A%20%20%20%20%20%20%20%20%3FawardStat%20ps%3AP166%20%3Faward%20.%20%20%20%20%20%20%20%20%23%20...%20that%20has%20any%20of%20the%20values%20of%20%3Faward%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP805%20%3FawardEdition%20.%20%23%20Get%20the%20award%20edition%20(which%20is%20%22subject%20of%22%20XXth%20Academy%20Awards)%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20OPTIONAL%20%7B%0A%20%20%20%20%20%20%20%20%3FawardEdition%20wdt%3AP585%20%3Ftime%20.%20%23%20the%20%22point%20of%20time%22%20of%20the%20Academy%20Award%0A%20%20%20%20%20%20%20%20%3FawardWork%20wdt%3AP57%20%3Fdirector%20.%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20GROUP%20BY%20%3FawardWork%20%3Faward%20%23%20We%20only%20want%20every%20movie%20once%20for%20a%20category%20(a%20'random'%20person%20is%20selected)%0A%20%20%7D%0A%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%23%20...%20include%20the%20labels%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22%20.%0A%20%20%7D%0A%7D%0AORDER%20BY%20DESC(%3Ftime)" referrerpolicy="origin" sandbox="allow-scripts allow-same-origin allow-popups"></iframe>



[données]: https://query.wikidata.org/#%23Donn%C3%A9es%20sur%20les%20Oscars%0ASELECT%20%3Fhuman%20%3FhumanLabel%20%3FawardEditionLabel%20%3FawardLabel%20%3FawardWork%20%3FawardWorkLabel%20%3Fdirector%20%3FdirectorLabel%20%3Ftime%0AWHERE%0A%7B%0A%20%20%7B%0A%20%20%20%20SELECT%20%28SAMPLE%28%3Fhuman%29%20AS%20%3Fhuman%29%20%3Faward%20%3FawardWork%20%28SAMPLE%28%3Fdirector%29%20AS%20%3Fdirector%29%20%28SAMPLE%28%3FawardEdition%29%20AS%20%3FawardEdition%29%20%28SAMPLE%28%3Ftime%29%20AS%20%3Ftime%29%20WHERE%20%7B%0A%20%20%20%20%20%20%3Faward%20wdt%3AP31%20wd%3AQ19020%20.%20%20%20%20%20%20%23%20All%20items%20that%20are%20instance%20of%28P31%29%20of%20Academy%20awards%20%28Q19020%29%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%3Fhuman%20p%3AP166%20%3FawardStat%20.%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Humans%20with%20an%20awarded%28P166%29%20statement%0A%20%20%20%20%20%20%20%20%3FawardStat%20ps%3AP166%20%3Faward%20.%20%20%20%20%20%20%20%20%23%20...%20that%20has%20any%20of%20the%20values%20of%20%3Faward%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP805%20%3FawardEdition%20.%20%23%20Get%20the%20award%20edition%20%28which%20is%20%22subject%20of%22%20XXth%20Academy%20Awards%29%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP1686%20%3FawardWork%20.%20%23%20The%20work%20they%20have%20been%20awarded%20for%0A%20%20%20%20%20%20%20%20%3Fhuman%20wdt%3AP31%20wd%3AQ5%20.%20%20%20%20%20%20%20%20%23%20Humans%0A%20%20%20%20%20%20%7D%20UNION%20%7B%0A%20%20%20%20%20%20%20%20%3FawardWork%20wdt%3AP31%20wd%3AQ11424%20.%20%23%20Films%0A%20%20%20%20%20%20%20%20%3FawardWork%20p%3AP166%20%3FawardStat%20.%20%23%20...%20with%20an%20awarded%28P166%29%20statement%0A%20%20%20%20%20%20%20%20%3FawardStat%20ps%3AP166%20%3Faward%20.%20%20%20%20%20%20%20%20%23%20...%20that%20has%20any%20of%20the%20values%20of%20%3Faward%0A%20%20%20%20%20%20%20%20%3FawardStat%20pq%3AP805%20%3FawardEdition%20.%20%23%20Get%20the%20award%20edition%20%28which%20is%20%22subject%20of%22%20XXth%20Academy%20Awards%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20OPTIONAL%20%7B%0A%20%20%20%20%20%20%20%20%3FawardEdition%20wdt%3AP585%20%3Ftime%20.%20%23%20the%20%22point%20of%20time%22%20of%20the%20Academy%20Award%0A%20%20%20%20%20%20%20%20%3FawardWork%20wdt%3AP57%20%3Fdirector%20.%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20FILTER%28%20%3Ftime%20%3C%3D%20%222021-01-01T00%3A00%3A00%22%5E%5Exsd%3AdateTime%20%29.%0A%20%20%20%20%7D%0A%20%20%20%20GROUP%20BY%20%3FawardWork%20%3Faward%20%23%20We%20only%20want%20every%20movie%20once%20for%20a%20category%20%28a%20%27random%27%20person%20is%20selected%29%0A%20%20%20%20%0A%20%20%7D%0A%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%23%20...%20include%20the%20labels%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22%20.%0A%20%20%7D%0A%7D%0AORDER%20BY%20DESC%28%3Ftime%29%0A

## Traitement de données en table

En utilisant le fichier de données `csv` sur les bornes de recharges de véhicules électriques de la
Ville de Nice disponible à cette adresse:

https://www.data.gouv.fr/fr/datasets/bornes-de-recharges-ville-de-nice/

1. Télécharger le fichier, puis l'ouvrir avec Python comme décrit dans le cours de [première].
   Commencer par afficher toutes les lignes.
2. Filtrer les données pour n'afficher que les stations présentant une puissance de 50kW. Les
   compter avec un algorithme.
3. Calculer la puissance moyenne des stations de charge en ne tenant compte que des stations pour
   lesquelles les données sont présentes.
4. En vous aidant du cours de [première], vérifier si les données ne présentent pas de doublons.
5. Trouver quelle est la station de recharge la plus proche du lycée Estienne d'Orves dont la
   coordonnée GPS est: 43° 42′ 01″ nord, 7° 15′ 01″ est soit en notation décimale
   [43.700278,7.250278]. On pourra utiliser la fonction
   [`dist`](https://docs.python.org/fr/3.10/library/math.html#math.dist) du module math pour
   calculer la distance euclidienne entre deux points.

[première]: /1g/nsi/4-traitement-de-donnees-en-tables/1-tables-de-donnees