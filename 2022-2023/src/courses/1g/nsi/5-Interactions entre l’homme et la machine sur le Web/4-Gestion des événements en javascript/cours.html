<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.146">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="cours_files/libs/clipboard/clipboard.min.js"></script>
<script src="cours_files/libs/quarto-html/quarto.js"></script>
<script src="cours_files/libs/quarto-html/popper.min.js"></script>
<script src="cours_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cours_files/libs/quarto-html/anchor.min.js"></script>
<link href="cours_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cours_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cours_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cours_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cours_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<details class="programme"><summary>Programme Officiel</summary>
<table class="table table-bordered table-hover">
<thead class="table-warning">
<tr class="header">
<th>Contenus</th>
<th>Capacités attendues</th>
<th>Commentaires</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Modalités de l’interaction entre l’homme et la machine</p>
<p>Événements</p></td>
<td><p>Identifier les différents composants graphiques permettant d’interagir avec une application Web</p>
<p>Identifier les événements que les fonctions associées aux différents composants graphiques sont capables de traiter</p></td>
<td>Il s’agit d’examiner le code HTML d’une page comprenant des composants graphiques et de distinguer ce qui relève de la description des composants graphiques en HTML de leur comportement (réaction aux événements) programmé par exemple en JavaScript.</td>
</tr>
</tbody>
</table>
<a class="lien-programme" href="../programme/">Lien vers le programme complet</a></details>

<div class="intro quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Le <code>javascript</code> a été créé en 1995 par Brendan Eich, il est utilisé pour programmer le navigateur côté <em>client</em>. <strong>Attention</strong> à ne pas confondre le <code>javascript</code> et le <code>java</code>, ce sont des langages différents.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><wc-wikimage title="Unofficial_JavaScript_logo_2.svg"></wc-wikimage></p>
</div>
</div>
</div>
<h2 id="intégration-de-code-javascript-dans-une-page-html" class="anchored">Intégration de code <code>javascript</code> dans une page <code>html</code></h2>
<p>Le code <code>javascript</code> peut être intégré à un document <code>html</code> grâce à la balise <code>&lt;script&gt;</code>.</p>
<p>Les fichiers <code>javascript</code> utilisent l’extension <code>.js</code> que l’on importe en précisant son URI grâce à l’attribut <code>src</code>.</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">"script.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>

<p><em>Remarque:</em> Bien qu’il soit recommandé de placer la balise <code>&lt;script&gt;</code> dans le <code>&lt;head&gt;</code> du document, il est très fréquent de voir le <code>javascript</code> placé juste avant la balise fermante <code>&lt;body&gt;</code>. Ceci permet d’être sûr que l’ensemble de la page web ait été <em>parsée</em>(analysée) par le navigateur avant de la modifier avec le code <code>javascript</code>.</p>
<details class="plus"><summary>Intégrer le `javascript` directement dans la page `html`</summary>
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"fr"</span><span class="p">&gt;</span>
<span class="p">  &lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">    &lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span> <span class="p">/&gt;</span>
<span class="p">    &lt;</span><span class="nt">title</span><span class="p">&gt;</span>Un peu de javascript<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">  &lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">  &lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">    &lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Titre principal de mon document<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">    &lt;</span><span class="nt">p</span><span class="p">&gt;</span>
      Regarde maman, je suis en train d'ajouter du code `javascript` à ma page.
<span class="p">    &lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">     &lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">&gt;</span>
<span class="w">      </span><span class="c1">// Je suis un commentaire javascript!</span>
<span class="w">      </span><span class="c1">// Alert crée une fenêtre d'affichage sur l'écran pour l'utilisateur</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">'Hello world !'</span><span class="p">)</span><span class="w"> </span><span class="c1">// L'affichage alert est un peu vieillot</span>
<span></span>
<span class="w">      </span><span class="c1">// console.log() écrit dans la console du navigateur pour le développeur</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Script Hello world exécuté.'</span><span class="p">)</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">  &lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>

</details>

<h2 id="débogage-du-javascript" class="anchored">Débogage du <code>javascript</code></h2>
<p>Pour déboguer du code <code>javascript</code>, on utilise le plus souvent <strong>la console du navigateur</strong>( <kbd>Ctrl</kbd> + <kbd>Maj</kbd> + <kbd>I</kbd>). Puis on y affiche des valeurs de variables depuis le programme <code>javascript</code> avec la fonction <code>console.log()</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/debogage-js-console.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Copie d’écran de la console du navigateur web firefox</figcaption><p></p>
</figure>
</div>
<h2 id="syntaxe-du-javascript" class="anchored">Syntaxe du <code>javascript</code></h2>
<p>Voici quelques bases de sa syntaxe, vous pouvez trouver un comparatif avec Python dans la page <a href="../../7-langages-et-programmation/7-comparaisons-de-langages/">Comparaison des langages</a></p>
<ul>
<li>Les variables doivent être déclarées grâce au mot clé <code>var</code>(ou <code>const</code> et <code>let</code> dans les versions récentes).</li>
<li>Tout comme en python, les <strong>chaînes de caractères</strong> sont entourées de <strong>guillemets</strong> simples ou doubles.</li>
<li>Les instructions simples sont terminées par un <strong>point-virgule</strong>: <code>;</code>(il n’est cependant pas toujours indispensable contrairement au <code>css</code>).</li>
<li>Les <strong>blocs d’instructions</strong> sont entourés d’<strong>accolades</strong>.</li>
<li>Les <strong>commentaires</strong> sont notés précédés de deux barres obliques: <code>//</code>.</li>
<li>Les variables et fonctions sont écrites en <code>camelCase</code>(L’espace est remplacé par une majuscule).</li>
<li>L’indentation des blocs d’instruction n’est pas obligatoire comme en Python, mais souhaitable.</li>
</ul>
<p>La référence la plus complète et à jour est le site Mozilla Developper Network <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Guide">MDN</a>.</p>
<p>Le chapitre <a href="/1g/nsi/7-langages-et-programmation/7-comparaisons-de-langages">Comparaison de langages</a> permet de faire le lien entre la syntaxe Python et la syntaxe javascript. <strong>Voir notamment la syntaxe concernant les <a href="/1g/nsi/7-langages-et-programmation/7-comparaisons-de-langages/#fonctions">fonctions</a> qui sont omniprésentes en javascript.</strong></p>
<h2 id="interaction-au-sein-dune-page-web-les-événements" class="anchored">Interaction au sein d’une page web: les événements</h2>
<p>Pour que la page réagisse aux actions de l’utilisateur, on ajoute des <code>EventHandler</code><em>(gestionnaires d’événements)</em> aux balises <code>html</code> qui doivent exécuter du code <code>javascript</code> en réponse aux événements.</p>
<p>Par exemple, pour exécuter la fonction javascript <code>initFunction</code> lorsque la balise <code>&lt;body&gt;</code> a fini de se charger.</p>
<p>Dans le fichier <code>html</code>:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">body</span> <span class="na">onload</span><span class="o">=</span><span class="s">"initFunction();"</span><span class="p">&gt;</span>
</pre></div>

<p>Dans le fichier <code>js</code>:</p>
<div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">initFunction</span><span class="p">(){</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Page ouverte à "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">now</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"h"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">now</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Voici quelques exemples d’événements courants.</p>
<table class="table table-bordered table-hover">
<thead class="table-warning">
<tr class="header">
<th><code>EventHandler</code></th>
<th>Type d’événement géré</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>onclick</code></td>
<td>clic de la souris sur l’élément</td>
</tr>
<tr class="even">
<td><code>ondblclick</code></td>
<td>double-clic de la souris sur l’élément</td>
</tr>
<tr class="odd">
<td><code>onkeypress</code></td>
<td>appuie sur une touche du clavier</td>
</tr>
<tr class="even">
<td><code>onkeyup</code></td>
<td>touche de clavier relâchée</td>
</tr>
<tr class="odd">
<td><code>onselect</code></td>
<td>élément sélectionné</td>
</tr>
</tbody>
</table>
<p>La liste complète des <code>GlobalEventHandlers</code> sur <a href="https://developer.mozilla.org/fr/docs/Web/API/GlobalEventHandlers">MDN</a></p>
<h2 id="html-js-comment-récupérer-une-entrée-utilisateur" class="anchored"><code>HTML → JS</code>: Comment récupérer une entrée utilisateur ?</h2>
<p>La balise html <code>&lt;input&gt;</code> permet de récupérer les entrées utilisateur, il en existe de divers types:</p>
<ul>
<li><code>&lt;input type="text" ...</code>: Par défaut: entrée de texte.</li>
<li><code>&lt;input type="button" ...</code>: Un bouton(on préfèrera cependant la balise <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button"><code>&lt;button&gt;</code></a>).</li>
<li><code>&lt;input type="checkbox" ...</code>: Case à cocher.</li>
<li><code>&lt;input type="radio" ...</code>: un bouton radio qui permet de sélectionner une seule valeur parmi un groupe de différentes valeurs.</li>
</ul>
<p>Voici un exemple complet qui affiche la valeur tapée par l’utilisateur lorsqu’on clique sur un bouton.</p>
<p>

[Événements en javascript](embedded-codesandbox://evenements-javascript)

</p>
<p>Si on regarde cet exemple, on voit que pour récupérer une entrée:</p>
<ol type="1">
<li><p>Dans le <code>html</code>, on ajoute un <code>id</code> à la balise input que l’on souhaite récupérer:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">"mon-input"</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">"Taper votre texte ici"</span> <span class="p">/&gt;</span>
</pre></div>
</li>
<li><p>Dans le <code>js</code>, on accède à la valeur entrée dans l’élément que l’on affecte à une variable.</p>
<div class="highlight"><pre><span></span><span class="c1">// On récupère le texte dans la balise input</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">texte</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="sb">`#mon-input`</span><span class="p">).</span><span class="nx">value</span>
<span class="c1">// On l'affiche dans la console</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">texte</span><span class="p">)</span>
</pre></div>
</li>
</ol>
<details class="plus"><summary>&nbsp;</summary>
<p>Il est également possible de récupérer une entrée utilisateur avec la fonction <code>prompt()</code></p>
<div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">rep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prompt</span><span class="p">(</span><span class="s2">"Voulez-vous accéder à cette page ?"</span><span class="p">)</span>
</pre></div>

<p>Cependant, cela n’est plus très utilisé de nos jours.</p>
</details>

<h2 id="js-html-comment-afficher-du-texte-dynamiquement-sur-la-page" class="anchored"><code>JS → HTML</code>: Comment afficher du texte dynamiquement sur la page?</h2>
<h3 id="exécution-différée" class="anchored">Exécution différée</h3>
<p>Avant de modifier la page, il convient d’attendre que la page <code>html</code> soit chargée avant d’exécuter le code javascript. De nombreux développeurs placent le code <code>javascript</code> à la fin du corps du document avant la balise fermante <code>&lt;/body&gt;</code>.</p>
<p>Cependant, il est aussi possible et recommandé de lancer le code <code>javascript</code> qu’après le chargement de la fenêtre en plaçant le code dans une fonction qui s’exécute après le chargement de la page:</p>
<div class="highlight"><pre><span></span><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// code javascript à exécuter</span>
<span class="w">  </span><span class="c1">// après le chargement de la page</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'La page est chargée, je peux maintenant la modifier'</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<h3 id="accéder-à-un-élément-html" class="anchored">Accéder à un élément <code>html</code></h3>
<p>Pour accéder à un élément <code>html</code> à partir du <code>javascript</code>, on utilise la fonction <code>document.querySelector()</code>.</p>
<p>C’est une méthode qui permet de sélectionner les éléments comme en <code>css</code>.</p>
<div class="example">
<p>Vous avez un document <code>html</code> qui contient les éléments suivants:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">"grand-titre"</span><span class="p">&gt;</span>Titre principal de mon document<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"premier-paragraphe"</span><span class="p">&gt;</span>
  Regarde maman, je suis en train d'ajouter du code `javascript` à ma page.
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">"sous-titre"</span><span class="p">&gt;</span>Sous-titre de mon document<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</pre></div>

<p>On peut alors en <code>javascript</code> modifier leurs contenus grâce à la propriété <code>innerHTML</code>,</p>
<div class="highlight"><pre><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#premier-paragraphe'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"J'aimais pas l'ancien texte, je l'ai changé."</span>
</pre></div>

<p><strong>Attention:</strong> ne pas oublier de placer ce code dans la fonction <code>window.onload = function() { }</code> ou de placer votre balise <code>&lt;script&gt;</code> à la fin du <code>&lt;body&gt;</code>.</p>
</div>
<h3 id="modifier-les-styles" class="anchored">Modifier les styles</h3>
<p>Vous pouvez en fait modifier toutes les propriétés des éléments à partir de javascript. Voici par exemple comment modifier les styles grâce à la propriété <code>style</code>.</p>
<div class="highlight"><pre><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'h1.grand-titre'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#FFAA85'</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#grand-titre'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#AA00AA'</span>
</pre></div>

<h2 id="un-exemple-complet" class="anchored">Un exemple complet</h2>
<p>Voici un exemple complet qui commence par récupérer une entrée utilisateur(<code>HTML → JS</code>), puis qui modifie la page en fonction de sa réponse(<code>JS → HTML</code>).</p>
<p>

[Exemple complet de gestion des événements en javascript](embedded-codesandbox://evenements-javascript-complet)

</p>
<h2 id="pour-aller-plus-loin" class="anchored">Pour aller plus loin</h2>
<p>Le <code>javascript</code> étant un langage très à la mode, les tutoriels, cours et vidéos ne manquent pas. N’hésitez pas à consulter:</p>
<ul>
<li>le cours d’OpenClassroom <a href="https://openclassrooms.com/courses/apprenez-a-coder-avec-javascript">Apprenez à coder avec JavaScript</a></li>
<li><a href="https://www.codecademy.com/fr/learn/learn-javascript">codeacademy</a></li>
</ul>
<p>Ou encore les sites de référence comme:</p>
<ul>
<li><a href="https://developer.mozilla.org/fr/docs/Web/JavaScript">MDN</a></li>
<li><a href="http://www.w3schools.com/js/">w3schools</a></li>
</ul>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>