<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.146">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="cours_files/libs/clipboard/clipboard.min.js"></script>
<script src="cours_files/libs/quarto-html/quarto.js"></script>
<script src="cours_files/libs/quarto-html/popper.min.js"></script>
<script src="cours_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cours_files/libs/quarto-html/anchor.min.js"></script>
<link href="cours_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cours_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cours_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cours_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cours_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<details class="programme"><summary>Programme Officiel</summary>
<table class="table table-bordered table-hover">
<thead class="table-warning">
<tr class="header">
<th>Contenus</th>
<th>Capacités attendues</th>
<th>Commentaires</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dictionnaires par clés et valeurs</td>
<td><p>Construire une entrée de dictionnaire</p>
<p>Itérer sur les éléments d’un dictionnaire.</p></td>
<td><p>Il est possible de présenter les données EXIF d’une image sous la forme d’un enregistrement.</p>
<p>En Python, les p-uplets nommés sont implémentés par des dictionnaires.</p>
<p>Utiliser les méthodes <code>keys()</code>, <code>values()</code> et <code>items()</code></p></td>
</tr>
</tbody>
</table>
<a class="lien-programme" href="../programme/">Lien vers le programme complet</a></details>

<div class="intro quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Dans un dictionnaire les valeurs de la collection ne sont pas repéré par un index, mais par une <em>clé</em>. Ils ne possèdent donc pas d’ordre a priori, c’est une structure <em>non-ordonnée</em>. Les dernières versions de Python assurent cependant un ordre lors de leur itération.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><wc-wikimage title="Associative_array_as_linked_list.svg" caption="Les dictionnaires en Python sont ce que l'on appelle un tableau associatif."></wc-wikimage></p>
</div>
</div>
</div>
<h2 id="syntaxe" class="anchored">Syntaxe</h2>
<p>Les dictionnaires sont entourés d’accolades <code>{}</code>. Les clés doivent être des objets <em>imuables</em>, typiquement des <code>str</code>.</p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">'clé_1'</span><span class="p">:</span> <span class="n">valeur_1</span><span class="p">,</span> <span class="s1">'clé_n'</span><span class="p">:</span> <span class="n">valeur_n</span><span class="p">,</span> <span class="o">...</span><span class="s1">'clé_n'</span><span class="p">:</span> <span class="n">valeur_n</span><span class="p">}</span>
</pre></div>

<div class="cell" data-execution_count="1">
<div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'nom'</span><span class="p">:</span> <span class="s1">'Lagaffe'</span> <span class="p">,</span> <span class="s1">'prenom'</span><span class="p">:</span> <span class="s1">'Gaston'</span><span class="p">,</span> <span class="s1">'age'</span><span class="p">:</span> <span class="mi">22</span> <span class="p">}</span>
<span class="nb">type</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="1">
<div class="highlight"><pre><span></span>dict
</pre></div>

</div>
</div>
<p>Pour accéder aux éléments du dictionnaire, il suffit d’appeler la clé correspondante, d’autre part la fonction <code>len()</code> est également disponible.</p>
<div class="cell" data-execution_count="2">
<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="2">
<div class="highlight"><pre><span></span>3
</pre></div>

</div>
</div>
<div class="cell" data-execution_count="3">
<div class="highlight"><pre><span></span><span class="n">D</span><span class="p">[</span><span class="s1">'nom'</span><span class="p">]</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="3">
<div class="highlight"><pre><span></span>'Lagaffe'
</pre></div>

</div>
</div>
<div class="cell" data-execution_count="4">
<div class="highlight"><pre><span></span><span class="n">D</span><span class="p">[</span><span class="s1">'age'</span><span class="p">]</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="4">
<div class="highlight"><pre><span></span>22
</pre></div>

</div>
</div>
<h2 id="ajout-et-suppression-déléments" class="anchored">Ajout et suppression d’éléments</h2>
<p>Les dictionnaires étant <em><a href="https://fr.wiktionary.org/wiki/mutable">mutables</a></em>, on peut ajouter des éléments au dictionnaire en **assignant* des clés paire valeur à notre guise.</p>
<div class="cell" data-execution_count="5">
<div class="highlight"><pre><span></span><span class="n">D</span><span class="p">[</span><span class="s2">"expression"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"M'enfin"</span>
<span class="n">D</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="5">
<div class="highlight"><pre><span></span>{'nom': 'Lagaffe', 'prenom': 'Gaston', 'age': 22, 'expression': "M'enfin"}
</pre></div>

</div>
</div>
<p>On peut au contraire supprimer des éléments du dictionnaire avec la méthode <code>pop()</code>.</p>
<div class="cell" data-execution_count="6">
<div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"age"</span><span class="p">)</span>
<span class="n">D</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="6">
<div class="highlight"><pre><span></span>{'nom': 'Lagaffe', 'prenom': 'Gaston', 'expression': "M'enfin"}
</pre></div>

</div>
</div>
<h2 id="autres-méthodes-des-dictionnaires" class="anchored">Autres méthodes des dictionnaires</h2>
<p>Les méthodes des <code>dict</code>ionnaires sont décrites dans la <a href="https://docs.python.org/fr/3/library/stdtypes.html#sequence-types-list-tuple-range">documentation</a> ou grâce à l’appel <code>help(tuple)</code>, outre les méthodes d’itération il peut être utile de connaitre la méthode <code>get(clé)</code> qui renvoie la valeur associée à l clé ou <code>None</code> si la clé n’existe pas.</p>
<p>Cela permet d’éviter les exceptions du type <code>KeyError</code> si la clé n’existe pas.</p>
<div class="cell" data-execution_count="7">
<div class="highlight"><pre><span></span><span class="n">D</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="7">
<div class="highlight"><pre><span></span>{'nom': 'Lagaffe', 'prenom': 'Gaston', 'expression': "M'enfin"}
</pre></div>

</div>
</div>
<p>Par exemple, la clé <code>age</code> n’existe plus donc la syntaxe d’accés par clé renvoir une erreur.</p>
<div class="cell" data-execution_count="8">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s2">"nom"</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s2">"prenom"</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s2">"age"</span><span class="p">])</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>Lagaffe
Gaston
</pre></div>

</div>
<div class="cell-output cell-output-error">
<div class="highlight"><pre><span></span>KeyError: 'age'
</pre></div>

</div>
</div>
<p>Par contre, la méthode <code>get()</code> ne générera pas la <code>KeyError</code> et renverra <code>None</code> la clé n’existe pas.</p>
<div class="cell" data-execution_count="9">
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"nom"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"prenom"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"age"</span><span class="p">))</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>Lagaffe
Gaston
None
</pre></div>

</div>
</div>
<details class="plus"><summary>Documentation des dictionnaires</summary>
<div class="cell" data-execution_count="10">
<div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>Help on class dict in module builtins:
<span></span>
class dict(object)
 |  dict() -&gt; new empty dictionary
 |  dict(mapping) -&gt; new dictionary initialized from a mapping object's
 |      (key, value) pairs
 |  dict(iterable) -&gt; new dictionary initialized as if via:
 |      d = {}
 |      for k, v in iterable:
 |          d[k] = v
 |  dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
 |      in the keyword argument list.  For example:  dict(one=1, two=2)
 |  
 |  Built-in subclasses:
 |      StgDict
 |  
 |  Methods defined here:
 |  
 |  __contains__(self, key, /)
 |      True if the dictionary has the specified key, else False.
 |  
 |  __delitem__(self, key, /)
 |      Delete self[key].
 |  
 |  __eq__(self, value, /)
 |      Return self==value.
 |  
 |  __ge__(self, value, /)
 |      Return self&gt;=value.
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __getitem__(...)
 |      x.__getitem__(y) &lt;==&gt; x[y]
 |  
 |  __gt__(self, value, /)
 |      Return self&gt;value.
 |  
 |  __init__(self, /, *args, **kwargs)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  __ior__(self, value, /)
 |      Return self|=value.
 |  
 |  __iter__(self, /)
 |      Implement iter(self).
 |  
 |  __le__(self, value, /)
 |      Return self&lt;=value.
 |  
 |  __len__(self, /)
 |      Return len(self).
 |  
 |  __lt__(self, value, /)
 |      Return self&lt;value.
 |  
 |  __ne__(self, value, /)
 |      Return self!=value.
 |  
 |  __or__(self, value, /)
 |      Return self|value.
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  __reversed__(self, /)
 |      Return a reverse iterator over the dict keys.
 |  
 |  __ror__(self, value, /)
 |      Return value|self.
 |  
 |  __setitem__(self, key, value, /)
 |      Set self[key] to value.
 |  
 |  __sizeof__(...)
 |      D.__sizeof__() -&gt; size of D in memory, in bytes
 |  
 |  clear(...)
 |      D.clear() -&gt; None.  Remove all items from D.
 |  
 |  copy(...)
 |      D.copy() -&gt; a shallow copy of D
 |  
 |  get(self, key, default=None, /)
 |      Return the value for key if key is in the dictionary, else default.
 |  
 |  items(...)
 |      D.items() -&gt; a set-like object providing a view on D's items
 |  
 |  keys(...)
 |      D.keys() -&gt; a set-like object providing a view on D's keys
 |  
 |  pop(...)
 |      D.pop(k[,d]) -&gt; v, remove specified key and return the corresponding value.
 |      
 |      If the key is not found, return the default if given; otherwise,
 |      raise a KeyError.
 |  
 |  popitem(self, /)
 |      Remove and return a (key, value) pair as a 2-tuple.
 |      
 |      Pairs are returned in LIFO (last-in, first-out) order.
 |      Raises KeyError if the dict is empty.
 |  
 |  setdefault(self, key, default=None, /)
 |      Insert key with a value of default if key is not in the dictionary.
 |      
 |      Return the value for key if key is in the dictionary, else default.
 |  
 |  update(...)
 |      D.update([E, ]**F) -&gt; None.  Update D from dict/iterable E and F.
 |      If E is present and has a .keys() method, then does:  for k in E: D[k] = E[k]
 |      If E is present and lacks a .keys() method, then does:  for k, v in E: D[k] = v
 |      In either case, this is followed by: for k in F:  D[k] = F[k]
 |  
 |  values(...)
 |      D.values() -&gt; an object providing a view on D's values
 |  
 |  ----------------------------------------------------------------------
 |  Class methods defined here:
 |  
 |  __class_getitem__(...) from builtins.type
 |      See PEP 585
 |  
 |  fromkeys(iterable, value=None, /) from builtins.type
 |      Create a new dictionary with keys from iterable and values set to value.
 |  
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |  
 |  __hash__ = None
</pre></div>

</div>
</div>
</details>

<h2 id="itération-sur-les-dictionnaires" class="anchored">Itération sur les dictionnaires</h2>
<p>Les dictionnaires étant des associations de clés(<em>keys</em>) et de valeurs(<em>values</em>), il existe trois méthodes pour <em>itérer</em> sur les clés, les valeurs ou les deux.</p>
<h3 id="itération-sur-les-clés-keys" class="anchored">Itération sur les clés: <code>keys()</code></h3>
<div class="cell" data-execution_count="11">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="nb">    print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>nom
prenom
expression
</pre></div>

</div>
</div>
<p>Ou plus simplement.</p>
<div class="cell" data-execution_count="12">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
<span class="nb">    print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>nom
prenom
expression
</pre></div>

</div>
</div>
<h3 id="itération-sur-les-valeurs-values" class="anchored">Itération sur les valeurs: <code>values()</code></h3>
<div class="cell" data-execution_count="13">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="nb">    print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>Lagaffe
Gaston
M'enfin
</pre></div>

</div>
</div>
<h3 id="itération-sur-les-paires-clé-valeurs-items" class="anchored">Itération sur les paires clé, valeurs: <code>items()</code></h3>
<div class="cell" data-execution_count="14">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="nb">    print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">'=&gt;'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

<div class="cell-output cell-output-stdout">
<div class="highlight"><pre><span></span>nom =&gt; Lagaffe
prenom =&gt; Gaston
expression =&gt; M'enfin
</pre></div>

</div>
</div>
<h2 id="p-uplets-nommés" class="anchored">p-uplets nommés</h2>
<p>Il est possible de créer des p-uplets nommés afin de pouvoir accéder aux éléments de la collection par clé. Contrairement aux dictionnaires, ils sont immutables et donc potentiellement plus performants, ils sont cependant peu utilisés et nécessite d’être importé par le module <code>collections</code> avant d’être utilisé.</p>
<div class="cell" data-execution_count="15">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span></span>
<span class="n">Eleve</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Eleve'</span><span class="p">,</span> <span class="s1">'nom, age, classe, spécialité'</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">Eleve</span><span class="p">(</span><span class="s2">"John"</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="s2">"1g"</span><span class="p">,</span> <span class="s2">"nsi"</span> <span class="p">)</span>
<span class="n">e</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="15">
<div class="highlight"><pre><span></span>Eleve(nom='John', age=17, classe='1g', spécialité='nsi')
</pre></div>

</div>
</div>
<p>L’accès peut se faire en ajoutant un point et le nom de la clé. Il s’agit d’une <em>notation pointée</em> comme dans le cas d’appel de méthodes, cependant il n’y a pas de parenthèses, car il s’agit de valeurs et non de fonctions(On parle d’attributs de l’objet).</p>
<div class="cell" data-execution_count="16">
<div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">age</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="16">
<div class="highlight"><pre><span></span>17
</pre></div>

</div>
</div>
<div class="cell" data-execution_count="17">
<div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">spécialité</span>
</pre></div>

<div class="cell-output cell-output-display" data-execution_count="17">
<div class="highlight"><pre><span></span>'nsi'
</pre></div>

</div>
</div>
<h2 id="structures-imbriquées-avec-les-dictionnaires" class="anchored">Structures imbriquées avec les dictionnaires</h2>
<p>Tout comme nous avons vu les tableaux de tableau dans le chapitre précédent, il est possible d’imaginer des structures imbriquées avec des dictionnaires.</p>
<p>On va s’intéresser plus particulièrement à une liste de dictionnaire qui pourrait être obtenue par lecture d’un fichier de données <code>csv</code>.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>