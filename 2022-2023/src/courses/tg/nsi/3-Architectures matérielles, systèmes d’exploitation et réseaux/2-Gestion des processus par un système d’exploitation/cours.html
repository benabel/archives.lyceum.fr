<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="cours_files/libs/clipboard/clipboard.min.js"></script>
<script src="cours_files/libs/quarto-html/quarto.js"></script>
<script src="cours_files/libs/quarto-html/popper.min.js"></script>
<script src="cours_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cours_files/libs/quarto-html/anchor.min.js"></script>
<link href="cours_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cours_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cours_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cours_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cours_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<details class="programme"><summary>Programme Officiel</summary>
<table class="table table-bordered table-hover">
<thead class="table-warning">
<tr class="header">
<th><div class="highlight"><pre><span></span>   Contenus
</pre></div>
</th>
<th><div class="highlight"><pre><span></span>    Capacités attendues
</pre></div>
</th>
<th><div class="highlight"><pre><span></span>         Commentaires
</pre></div>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gestion des processus et des ressources par un système d’exploitation.</td>
<td><p>Décrire la création d’un processus, l’ordonnancement de plusieurs processus par le système.</p>
<p>Mettre en évidence le risque de l’interblocage (deadlock).</p></td>
<td>À l’aide d’outils standard, il s’agit d’observer les processus actifs ou en attente sur une machine. Une présentation débranchée de l’interblocage peut être proposée.</td>
</tr>
</tbody>
</table>
<a class="lien-programme" href="../programme/">Lien vers le programme complet</a></details>

<blockquote class="blockquote">
<p>Comme nous l’avons vu en première, le <a href="/1g/nsi/6-architectures-materielles-et-systemes-dexploitation/3-systemes-dexploitation/">système d’exploitation</a>(Linux, Windows, MacOs…) est un programme particulier situé entre le matériel et les applications qui a pour de rôle de coordonner l’ensemble des tâches qui sont exécutées par l’ordinateur. Cette année, nous allons voir comment le système d’exploitation charge les programmes dans la mémoire de masse et lance leur <em>exécution</em> en leur créant des <strong>processus</strong> afin de pouvoir les gérer lors de leur exécution.</p>
</blockquote>
<h2 id="différence-entre-programme-et-processus" class="anchored">Différence entre programme et processus</h2>
<dl>
<dt>
Programme
</dt>
<dd>
<div>
<p>Un <strong>programme est statique</strong>: c’est un fichier contenant une suite d’instructions qui lorsqu’elles sont exécutées modifient l’état du processeur et de la mémoire afin de réaliser une tâche donnée.</p>
</div>
</dd>
</dl>
<p>Un même programme peut-être exécuté <em>plusieurs fois</em> sur une même machine, il faut alors allouer à chacune de ces exécutions des ressources de mémoire et de processeur distinctes au cours de ces exécutions. C’est le système d’exploitation qui gère l’allocation de ces ressources.</p>
<dl>
<dt>
Processus
</dt>
<dd>
<div>
<p>Un <strong>processus est dynamique</strong>: c’est une instance d’exécution d’un programme sur une machine de son lancement jusqu’à sa fin.</p>
</div>
</dd>
</dl>
<p>Les systèmes d’exploitation permettent à l’utilisateur de visualiser et gérer les processus grâce à un <strong>gestionnaire de processus</strong>.</p>
<details class="appli"><summary>Programmes et processus sous linux</summary>
<!-- TODO personnaliser image docker de binder -->
<p>Si vous êtes sous linux ou OSX, vous pouvez simplement lancer un terminal pour ouvrir une console. Sinon vous pouvez lancer une instance jupyterlab en ligne grâce à Binder.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://mybinder.org/v2/gh/binder-examples/jupyterlab/master?urlpath=lab/tree/index.ipynb"><img src="http://mybinder.org/badge_logo.svg" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Binder</figcaption><p></p>
</figure>
</div>
<p>Sous linux, les programmes sont par <a href="https://fr.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">convention</a> situées dans les dossiers <code>bin</code> pour binaries en anglais:</p>
<ul>
<li><code>/bin/</code>: commandes de base nécessaires au démarrage et à l’utilisation d’un système minimaliste.</li>
<li><code>/sbin/</code>: Exécutables pour les administrateurs (abréviation de system binaries, soit binaires système en français).</li>
<li><code>/usr/bin/</code>: Binaires exécutables qui ne sont pas déjà présents dans <code>/bin</code> et donc pas indispensables à un système minimaliste.</li>
</ul>
<p>On peut <strong>lister les programmes</strong> avec la commande <code>ls</code> et les exécuter en tapant leur nom dans une console.</p>
<div class="highlight"><pre><span></span><span class="c1"># la commande ls vue en première (abbréviation de list en anglais)</span>
ls<span class="w"> </span>/bin
<span></span>
ls<span class="w"> </span>/sbin
<span></span>
ls<span class="w"> </span>/usr/bin
</pre></div>

<p>Vous pouvez <strong>afficher un programme</strong> en particulier grâce à la commande <code>cat</code>.</p>
<p><code>cat /bin/ls</code></p>
<p>Comme vous le voyez c’est un fichier binaire car ce programme a été compilé pour s’exécuter plus rapidement.</p>
<p>Vous pouvez <strong>lancer un programme</strong> en particulier en écrivant son <code>nom</code> (sans préciser son chemin s’il appartient au <code>PATH</code>).</p>
<div class="highlight"><pre><span></span><span class="c1"># affichage sortie</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">"Voulez-vous continuer"</span>
<span class="c1"># lecture entrée</span>
<span class="nb">read</span><span class="w"> </span>
</pre></div>

<p>Maintenant si vous voulez <strong>lister les processus</strong> en cours d’exécution on utilise la commande <code>ps</code>.</p>
<div class="highlight"><pre><span></span><span class="c1"># affiche mes processus en exécution</span>
ps
<span class="c1"># affiche tous les processus</span>
ps<span class="w"> </span>-A
<span class="c1"># affiche une aide simple</span>
ps<span class="w"> </span>--help<span class="w"> </span>s
</pre></div>

<p>Voici un exemple de sortie avec l’option <code>-l</code> pour obtenir plus détails:</p>
<div class="highlight"><pre><span></span><span class="n">jovyan</span><span class="nv">@jupyter</span><span class="o">-</span><span class="n">jupyterlab</span><span class="o">-</span><span class="mi">2</span><span class="n">djupyterlab</span><span class="o">-</span><span class="mi">2</span><span class="n">ddemo</span><span class="o">-</span><span class="mi">2</span><span class="nl">dgmyobfo6</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">lA</span>
<span class="n">F</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="n">UID</span><span class="w">     </span><span class="n">PID</span><span class="w">    </span><span class="n">PPID</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="n">PRI</span><span class="w">  </span><span class="n">NI</span><span class="w"> </span><span class="n">ADDR</span><span class="w"> </span><span class="n">SZ</span><span class="w"> </span><span class="n">WCHAN</span><span class="w">  </span><span class="n">TTY</span><span class="w">          </span><span class="nc">TIME</span><span class="w"> </span><span class="n">CMD</span>
<span class="mi">4</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mi">1000</span><span class="w">       </span><span class="mi">1</span><span class="w">       </span><span class="mi">0</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">137942</span><span class="w"> </span><span class="n">epoll_</span><span class="w"> </span><span class="vm">?</span><span class="w">       </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="n">jupyter</span><span class="o">-</span><span class="n">noteboo</span>
<span class="mi">0</span><span class="w"> </span><span class="n">Z</span><span class="w">  </span><span class="mi">1000</span><span class="w">    </span><span class="mi">2293</span><span class="w">       </span><span class="mi">1</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">     </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">      </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">dash</span><span class="w"> </span><span class="o">&lt;</span><span class="n">defunct</span><span class="o">&gt;</span>
<span class="mi">4</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mi">1000</span><span class="w">    </span><span class="mi">4031</span><span class="w">       </span><span class="mi">1</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="mi">5116</span><span class="w"> </span><span class="n">wait</span><span class="w">   </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
<span class="mi">4</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mi">1000</span><span class="w">    </span><span class="mi">4900</span><span class="w">    </span><span class="mi">4031</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="mi">5083</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
<span class="mi">4</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mi">1000</span><span class="w">    </span><span class="mi">5105</span><span class="w">       </span><span class="mi">1</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="mi">5116</span><span class="w"> </span><span class="n">wait</span><span class="w">   </span><span class="n">pts</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
<span class="mi">0</span><span class="w"> </span><span class="n">R</span><span class="w">  </span><span class="mi">1000</span><span class="w">    </span><span class="mi">5984</span><span class="w">    </span><span class="mi">5105</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">80</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="mi">6910</span><span class="w"> </span><span class="o">-</span><span class="w">      </span><span class="n">pts</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">ps</span>
</pre></div>

<p>On peut créer des affichages particuliers par exemple pour voir quels processus sont les plus gourmands en mémoire: <code>ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head</code></p>
<div class="highlight"><pre><span></span>PID    PPID CMD                         %MEM %CPU
  1       0 /srv/conda/envs/notebook/bi  0.1 17.0
122       1 /srv/conda/envs/notebook/bi  0.0  4.6
 84       1 /bin/bash -l                 0.0  1.7
137      84 ps -eo pid,ppid,cmd,%mem,%c  0.0  0.0
138      84 head                         0.0  0.0
</pre></div>

<p>Enfin on peut <strong>tuer un processus</strong> avec la commande <code>kill</code>.</p>
<div class="highlight"><pre><span></span># tuer avec le PID processus id
kill 122
# tuer par le nom du programme ATTENTION cela tue votre instance binder
# pkill jupyter 
</pre></div>

</details>

<h2 id="les-états-dun-processus" class="anchored">Les états d’un processus</h2>
<p>Un processus n’a pas seulement besoin d’accéder au processeur, mais il a souvent besoin d’accéder à des <em>ressources</em> autres comme:</p>
<ul>
<li>La mémoire vive: RAM,</li>
<li>La mémoire de masse: disques durs, clés USB, mémoire flash…</li>
<li>La lecture ou l’écriture d’un fichier…</li>
<li>Les périphériques d’entrée et de sortie: clavier, souris, écran, imprimante…</li>
</ul>
<p>Ces <em>ressources</em> externes étant beaucoup moins rapides que le processeur, elles <strong>bloquent</strong> les processus lors de leur exécution.</p>
<p>Ainsi, lors de la vie d’un processus, celui-ci peut passer par trois états:</p>
<ul>
<li><strong>PRÊT</strong>: le processus est lancé et <em>attend l’accès au processeur</em>.</li>
<li><strong>ÉLU</strong>: le processus a obtenu l’accès au processeur: il peut s’exécuter.</li>
<li><strong>BLOQUÉ</strong>: le processus est en cours d’exécution, mais <em>attend une ressource</em> en mémoire par exemple, il quitte le processeur pour libérer les ressources.</li>
</ul>
<p><wc-wikimage class="half center" title="Diagrammedétatdunprocessus_1.png" caption="Les trois états d'un processus, et le passage d'un état à un autre."></wc-wikimage></p>
<h2 id="ordonnancement" class="anchored">Ordonnancement</h2>
<p>À un instant donné, il y a souvent davantage de processus à exécuter que de processeurs.</p>
<p>Lors de leur lacement les processus sont placés dans une <a href="/tg/nsi/1-structures-de-donnees/3-structures-lineaires-piles-files">file</a> d’attente.</p>
<p>L’ordonnanceur désigne le composant du noyau du système d’exploitation choisissant l’ordre d’exécution des processus sur les processeurs d’un ordinateur.</p>
<p>Il existe divers algorithmes d’ordonnancement:</p>
<ul>
<li><strong>La méthode du tourniquet</strong> (<em>Round Robin</em>): l’ordonnanceur traite la file d’attente comme une file circulaire et alloue successivement un temps processeur à chacun des processus de la file.</li>
<li><strong>FIFO</strong>: First In First Out (voir le <a href="/tg/nsi/1-structures-de-donnees/3-structures-lineaires-piles-files">cours sur les files</a>)</li>
<li><strong>SJF</strong> Shortest job first (SJF, ou SJN -Shortest Job Next-).</li>
<li>…</li>
</ul>
<p><a href="https://fr.wikipedia.org/wiki/Ordonnancement_dans_les_systèmes_d'exploitation" class="cite-source">Article Wikipédia sur l’ordonnancement</a></p>
<h2 id="interblocage" class="anchored">Interblocage</h2>
<dl>
<dt>
interblocage
</dt>
<dd>
<div>
<p>Un interblocage (ou étreinte fatale, <em>deadlock</em> en anglais pour impasse) est un phénomène qui peut se produire en programmation concurrente lorsque des processus s’attendent mutuellement.</p>
</div>
</dd>
</dl>
<div class="example">
<p>Un exemple concret d’interblocage peut se produire lorsque deux processus essayent d’acquérir deux ressources dans un ordre différent.</p>
<p><a href="https://commons.wikimedia.org/wiki/File:Process_deadlock.svg#/media/File:Process_deadlock.svg"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Process_deadlock.svg/1200px-Process_deadlock.svg.png" alt="Process deadlock.svg"></a></p>
<ul>
<li>P1 acquiert R1.</li>
<li>P2 acquiert R2.</li>
<li>P1 attend pour acquérir R2 (qui est détenu par P2).</li>
<li>P2 attend pour acquérir R1 (qui est détenu par P1).</li>
</ul>
<p>Dans cette situation, les deux processus sont définitivement bloqués.</p>
</div>
<div class="example">
<p>Deux processus en concurrence pour deux ressources dans un ordre opposé.</p>
<p>
<a href="https://commons.wikimedia.org/wiki/File:Two_processes,_two_resources.gif#/media/File:Two_processes,_two_resources.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/d/df/Two_processes%2C_two_resources.gif" alt="Two processes, two resources.gif"></a><br>By <a href="//commons.wikimedia.org/w/index.php?title=User:Abacoo&amp;amp;action=edit&amp;amp;redlink=1" class="new" title="User:Abacoo (page does not exist)">Abacoo</a> - <span class="int-own-work" lang="en">Own work</span>, <a href="https://creativecommons.org/licenses/by-sa/4.0" title="Creative Commons Attribution-Share Alike 4.0">CC BY-SA 4.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=47971211">Link</a>
</p>
<ul>
<li><strong>A</strong> Un seul processus se déroule.</li>
<li><strong>B</strong> Le processus ultérieur doit attendre.</li>
<li><strong>C</strong> Un blocage se produit lorsque le premier processus verrouille la première ressource en même temps que le second processus verrouille la seconde ressource.</li>
<li><strong>D</strong> Le blocage peut être résolu en annulant et en redémarrant le premier processus.</li>
</ul>
</div>
<p>Il existe plusieurs façons de gérer les interblocages:</p>
<ul>
<li>les <em>ignorer</em> ce qui était fait initialement par UNIX qui supposait que la fréquence des interblocages était faible et que la perte de données encourue à chaque fois est tolérable.</li>
<li>les <em>détecter</em>: Un algorithme est utilisé pour suivre l’allocation des ressources et les états des processus, il annule et redémarre un ou plusieurs processus afin de supprimer le blocage détecté</li>
<li>les <em>éviter</em>: des <a href="https://en.wikipedia.org/wiki/Deadlock_prevention_algorithms">algorithmes</a> sont utilisés pour supprimer une des quatre conditions nécessaires à la possibilité de l’interblocage(<a href="https://fr.wikipedia.org/wiki/Interblocage#Conditions_n%C3%A9cessaires">Conditions de Coffman</a>)</li>
</ul>
<details class="plus"><summary>Conditions de Coffman</summary>
<p>Coffman a prouvé en 1971 qu’il y a quatre conditions nécessaires pour qu’un blocage puisse avoir lieu.</p>
<p>Voir l’article Wikipédia <a href="https://fr.wikipedia.org/wiki/Interblocage#Conditions_n%C3%A9cessaires">Conditions de Coffman</a> pour plus de détails.</p>
</details>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>