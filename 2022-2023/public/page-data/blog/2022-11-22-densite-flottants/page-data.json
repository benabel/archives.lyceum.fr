{"componentChunkName":"component---src-templates-blog-md-js","path":"/blog/2022-11-22-densite-flottants/","result":{"data":{"markdownRemark":{"html":"<div class=\"intro\">\n<p>Pour rappel, il est très fréquent d’encoder les nombres à virgule sous forme de nombre flottant sous la forme:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mtext>&nbsp;</mtext><mi>m</mi><mo>⋅</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\ns\\ m \\cdot 2^n\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\">&nbsp;</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7144em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span></span>\n</p>\n<p><wc-wikimage title=\"General_floating_point.svg\" caption=\"Pour encoder un nombre flottant on\nutilise 1 bit de signe f bits pour la mantisse et e bits pour l'exposant.\"></wc-wikimage></p>\n<p>Il faut cependant bien comprendre que la représentation des nombres flottants est loin d’être continue comme les nombres réels mathématiques.</p>\n</div>\n<h2 id=\"représentation-dun-nombre-normalisée\" class=\"anchored\">Représentation d’un nombre normalisée</h2>\n<ul>\n<li>le signe, +1 ou -1, sous la forme d’un bit&nbsp;;</li>\n<li>l’exposant décalé, sous la forme de e bits représentant un nombre entier&nbsp;;</li>\n<li>la mantisse, sous la forme de m bits représentant un nombre positif strictement inférieur à 1.</li>\n</ul>\n<p>La valeur du nombre représenté vaut&nbsp;: valeur = signe × (1 + mantisse) × 2^(exposant − décalage)^</p>\n<p>C’est ce qu’on appelle la représentation d’un <a href=\"https://fr.wikipedia.org/wiki/Nombre_d%C3%A9normalis%C3%A9#Repr%C3%A9sentation_d'un_nombre_normalis%C3%A9\">nombre normalisé</a>.</p>\n<p>Tous les nombres réels ne sont pas représentés et les nombres ne sont pas régulièrement espacés comme le montre la représentation graphique ci-dessous pour des nombres flottants représentés sur 7 bits avec 3 bits de mantisse et 3 bits d’exposant.</p>\n<div class=\"cell\" data-execution_count=\"1\">\n<div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">matplotlib</span> <span class=\"kn\">import</span> <span class=\"n\">ticker</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.stats</span> <span class=\"kn\">import</span> <span class=\"n\">gaussian_kde</span>\n<span class=\"kn\">from</span> <span class=\"nn\">lyceum.repr</span> <span class=\"kn\">import</span> <span class=\"n\">bin2float</span>\n<span class=\"c1\"># On limite les points pour y voir quelquechose</span>\n<span class=\"n\">NBITS</span> <span class=\"o\">=</span> <span class=\"mi\">7</span>\n<span class=\"n\">EXPOSANT</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">MANTISSE</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">x_list</span><span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">i</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"n\">NBITS</span><span class=\"p\">)]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">x_list</span><span class=\"p\">)</span>\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">x_list</span><span class=\"p\">)</span>\n<span class=\"n\">x_bin</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"nb\">format</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">'0</span><span class=\"si\">{</span><span class=\"n\">NBITS</span><span class=\"si\">}</span><span class=\"s1\">b'</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x</span><span class=\"p\">])</span>\n<span></span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"n\">bin2float</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">e</span><span class=\"o\">=</span><span class=\"n\">EXPOSANT</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"o\">=</span><span class=\"n\">MANTISSE</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x_bin</span><span class=\"p\">])</span>\n<span></span>\n<span class=\"c1\"># Calculate the point density</span>\n<span class=\"n\">xy</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">vstack</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">y</span><span class=\"p\">])</span>\n<span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"n\">gaussian_kde</span><span class=\"p\">(</span><span class=\"n\">xy</span><span class=\"p\">)(</span><span class=\"n\">xy</span><span class=\"p\">)</span>\n<span class=\"c1\"># Sort the points by density, so that the densest points are plotted last</span>\n<span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"n\">z</span><span class=\"o\">.</span><span class=\"n\">argsort</span><span class=\"p\">()</span>\n<span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"n\">x</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">],</span> <span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">],</span> <span class=\"n\">z</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span>\n<span></span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">()</span>\n<span class=\"n\">im</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">'+'</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"n\">z</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span></span>\n<span class=\"n\">xs</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">i</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x_list</span> <span class=\"k\">if</span> <span class=\"mi\">10</span><span class=\"o\">*</span><span class=\"n\">i</span> <span class=\"o\">%</span> <span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"p\">)</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">x_labels</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nb\">format</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">'0</span><span class=\"si\">{</span><span class=\"n\">NBITS</span><span class=\"si\">}</span><span class=\"s1\">b'</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">xs</span><span class=\"p\">]</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xticks</span><span class=\"p\">(</span><span class=\"n\">xs</span><span class=\"p\">,</span> <span class=\"n\">x_labels</span><span class=\"p\">,</span> <span class=\"n\">rotation</span><span class=\"o\">=</span><span class=\"s1\">'vertical'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlabel</span><span class=\"p\">(</span><span class=\"s2\">\"Valeur binaire\"</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s2\">\"Valeur décimale du nombre flottant\"</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'Densité des valeurs flottantes sur 7 bits(e=3, f=3)'</span><span class=\"p\">,</span><span class=\"n\">pad</span><span class=\"o\">=</span><span class=\"mi\">30</span><span class=\"p\">)</span>\n<span></span>\n<span class=\"c1\">\n# Add colorbar</span>\n<span class=\"n\">cbar</span> <span class=\"o\">=</span> <span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s2\">\"Densité des nombres\"</span><span class=\"p\">)</span>\n<span class=\"c1\">#ax.set_yscale('log')</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</pre></div>\n<div class=\"cell-output cell-output-display\">\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.48648648648648%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAB2HAAAdhwGP5fFlAAACLklEQVR42oVUiW7iMBDN/3/YqgKtykIR5VgELQnkvpzE91uNQ2iXhnakFzv2+HnG82wPV8uyDEEQ4HK5II5jnM9n1wZ+4PppmiLPc+dDvkVRoKoq3JtHH2MMuq5D27YOTdM4UL/rPv4/+7g5ziEFjdfoOg5rbU9YliUYY24HGhxA1tYdBJcjcxZCAHH8C2E0QZY1MEb3hMPOn+3KhzKtYbTBmGkJHKIpgnwJKWxPSOdEEd4TugVKo8oZHplVwOoyx/r8gjwpoJSCF0UROOcuSucEc0s3TWuURXNL94spi2d/hUWwQVMy1Iz1hFStIcJhYdI22IfpeGS4kmuDp+MG8/MBmgucfB8eSUBwjqgocGAJTu07ttURq+wCpQ20Nch4CK1DWJPDWvHBbAye9jtM9zvkceIk55G+pBAoGUMhWjSqAdfiFqmxFrXKoNUbrHxF2i2Ri+qDcLPD/PgOLYTTqBeGoRPs1yrb0XQNFPZ5hEZIl/xktcPv9V+UWYrT6QQvSZL/ivKgnlf08umERBhXbmw63+Jl8wajpRO/kw1dozHZfGcFCVkrPM92mP3ZosjTXjaPhP1tsHSDGAdvOWbTNV4Xh15wxvSEdIaEIfWfQH5VWaNhDIvJCvPJEnmZ9RHedJckTo9EPLwkJClq6X94YQjkU9cV6rqG1toR3V6bgdD3fedIZ0pSooW0ydASiHTIhq4rzY0+X2RCCLeTlNK1dB5ETNoi0OIhmsGPcE/4D/W9JVs7foViAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cell 2 output 1\" title=\"\" src=\"/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/fcda8/cell-2-output-1.png\" srcset=\"/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/12f09/cell-2-output-1.png 148w,\n/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/e4a3f/cell-2-output-1.png 295w,\n/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/fcda8/cell-2-output-1.png 590w,\n/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/efc66/cell-2-output-1.png 885w,\n/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/c83ae/cell-2-output-1.png 1180w,\n/2022-2023/static/f7d1e5727d62a320a09f8e4bf2d38a87/cd138/cell-2-output-1.png 1220w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span></p>\n</div>\n\n<p>On voit que la densité est plus importante pour les nombres autour de <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>0</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">10^0 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>\net plus faible pour les très petits et très grands nombres.</p>\n<h2 id=\"représentation-dun-nombre-dénormalisée\" class=\"anchored\">Représentation d’un nombre dénormalisée</h2>\n<p>La norme IEEE-754 prévoit d’attribuer des valeurs spéciales aux nombres ayant un exposant nul ou maximum.</p>\n<p>Notamment pour les nombres avec un exposant nul et une mantisse non nulle, on utilise une représentation d’un <a href=\"https://fr.wikipedia.org/wiki/Nombre_d%C3%A9normalis%C3%A9#Repr%C3%A9sentation_d'un_nombre_d%C3%A9normalis%C3%A9\">nombre dénormalisé</a>.</p>\n<p>La valeur du nombre représenté vaut&nbsp;: valeur = signe × (mantisse) × 2^− décalage^</p>\n<div class=\"cell\" data-execution_count=\"2\">\n<div class=\"highlight\"><pre><span></span><span class=\"c1\"># On limite les points pour y voir quelquechose</span>\n<span class=\"n\">NBITS</span> <span class=\"o\">=</span> <span class=\"mi\">7</span>\n<span class=\"n\">EXPOSANT</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">MANTISSE</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">x_list</span><span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">i</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"n\">NBITS</span><span class=\"p\">)]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">x_list</span><span class=\"p\">)</span>\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">x_list</span><span class=\"p\">)</span>\n<span class=\"n\">x_bin</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"nb\">format</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">'0</span><span class=\"si\">{</span><span class=\"n\">NBITS</span><span class=\"si\">}</span><span class=\"s1\">b'</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x</span><span class=\"p\">])</span>\n<span></span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"n\">bin2float</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">e</span><span class=\"o\">=</span><span class=\"n\">EXPOSANT</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"o\">=</span><span class=\"n\">MANTISSE</span><span class=\"p\">,</span> <span class=\"n\">ieee</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x_bin</span><span class=\"p\">])</span>\n<span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan_to_num</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">copy</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">nan</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"o\">-</span><span class=\"mf\">2.5</span><span class=\"p\">),</span> <span class=\"n\">posinf</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">neginf</span><span class=\"o\">=-</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"c1\"># Calculate the point density</span>\n<span class=\"n\">xy</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">vstack</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"n\">y</span><span class=\"p\">])</span>\n<span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"n\">gaussian_kde</span><span class=\"p\">(</span><span class=\"n\">xy</span><span class=\"p\">)(</span><span class=\"n\">xy</span><span class=\"p\">)</span>\n<span class=\"c1\"># Sort the points by density, so that the densest points are plotted last</span>\n<span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"n\">z</span><span class=\"o\">.</span><span class=\"n\">argsort</span><span class=\"p\">()</span>\n<span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"n\">x</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">],</span> <span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">],</span> <span class=\"n\">z</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span>\n<span></span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">()</span>\n<span class=\"n\">im</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">'+'</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"n\">z</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span></span>\n<span class=\"n\">xs</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">i</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">x_list</span> <span class=\"k\">if</span> <span class=\"mi\">10</span><span class=\"o\">*</span><span class=\"n\">i</span> <span class=\"o\">%</span> <span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"o\">**</span><span class=\"p\">(</span><span class=\"n\">NBITS</span><span class=\"p\">)</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">x_labels</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nb\">format</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">'0</span><span class=\"si\">{</span><span class=\"n\">NBITS</span><span class=\"si\">}</span><span class=\"s1\">b'</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">xs</span><span class=\"p\">]</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xticks</span><span class=\"p\">(</span><span class=\"n\">xs</span><span class=\"p\">,</span> <span class=\"n\">x_labels</span><span class=\"p\">,</span> <span class=\"n\">rotation</span><span class=\"o\">=</span><span class=\"s1\">'vertical'</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">xlabel</span><span class=\"p\">(</span><span class=\"s2\">\"Valeur binaire\"</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">ylabel</span><span class=\"p\">(</span><span class=\"s2\">\"Valeur décimale du nombre flottant\"</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"s1\">'Densité des valeurs flottantes sur 7 bits(e=3, f=3)'</span><span class=\"p\">,</span><span class=\"n\">pad</span><span class=\"o\">=</span><span class=\"mi\">15</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">suptitle</span><span class=\"p\">(</span><span class=\"s1\">'La norme IEEE754 est appliquée avec les valeurs normalisés les nan et les infinis'</span><span class=\"p\">)</span>\n<span class=\"c1\"># Add colorbar</span>\n<span class=\"n\">cbar</span> <span class=\"o\">=</span> <span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s2\">\"Densité des nombres\"</span><span class=\"p\">)</span>\n<span class=\"c1\">#ax.set_yscale('log')</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</pre></div></div>\n<div class=\"cell-output cell-output-display\">\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.37837837837837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACKklEQVR42oWU25KbMAyG8/7P1ZntNBedTXeBAgkQliTEnMPBGJu/I3NIs5tOyWikyPJnWbK9yfMcl8sFnufBNE3s93scDgdYlgXbtuG6Dnzfx/F4hOu6eoxiHcdGmqZgLEWSJGCMac5GSolxHLUzDEOcz2ecTidtkw6CQGuaQGNRFGn7ek3QNDnK4oQ0zSFED6UUNgDQdR2qqiJTw0noowAl1YN/GiMNXOId0vw7OAekHHTcZhgGcM5R1zU+f8MgkWVf/ZwLlDlHyCy48RZ11WFYgFSH2+2GpmnmcMpAaS2EBOfDF6DOXADOxYHBTEBOPg3MskxndwfOkzDigxWQ85axLjeutnE64EdoosoKsCSZgNRlgjVtAzkOUOoGpRiO9RFp284Q9RcQK3IXethGHqBGXBmbgGVZouccrCwQtR/oBxdc7MHl1KRGNii5A4h3cGGiHqoV/hYE+GbbKNMU8fV63/JjDZ99c2fRwr9FSNtOe3+5Pn4ejtpeMyyKQh+Zxy6rf6KlUoiTKUvDDfDy+ht5liDNsnuGBH12bJ5lSr+lUYblYffuz52fKruhdgsh/rNlPG2KZXjYvhgoqxx9LyagLnzTgLpN4L7vtZC9yOf/bd3qg2y+Onjb2o8ZLitTtwlKQmUgTaUgTTUmm/wUt1wG3nH0Xf+wgxW4vBjTCzJpEnoQCERCMQSkcVpouR1PgfTqLEKB9AjQxDiOtdC2yaevnVI67qGgM/APngrU2nd2oJoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cell 3 output 1\" title=\"\" src=\"/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/fcda8/cell-3-output-1.png\" srcset=\"/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/12f09/cell-3-output-1.png 148w,\n/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/e4a3f/cell-3-output-1.png 295w,\n/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/fcda8/cell-3-output-1.png 590w,\n/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/efc66/cell-3-output-1.png 885w,\n/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/c83ae/cell-3-output-1.png 1180w,\n/2022-2023/static/5bf870623bb61f5a8d218e0620dddfc7/cad6c/cell-3-output-1.png 1339w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span></p>\n</div>\n\n<p>On peut voir que l’on a perdu en étendue, mais cela d’avoir des points trop éloignés pour les grandes valeurs.</p>\n<p>D’autre part, grâce à la normalisation la densité semble plus uniforme.</p>","timeToRead":3,"fields":{"slug":"blog/2022-11-22-densite-flottants/"},"frontmatter":{"author":"Benjamin Abel","tags":["python","nombres flottants","graphique"],"title":"Densité des nombres flottants","date":"2022-11-22","tocHTML":"<ul><li><a href=\"#représentation-dun-nombre-normalisée\" data-localhref=\"true\">Représentation d’un nombre normalisée</a></li><li><a href=\"#représentation-dun-nombre-dénormalisée\" data-localhref=\"true\">Représentation d’un nombre dénormalisée</a></li></ul>"}}},"pageContext":{"slug":"blog/2022-11-22-densite-flottants/"}},"staticQueryHashes":["604483588"],"slicesMap":{}}